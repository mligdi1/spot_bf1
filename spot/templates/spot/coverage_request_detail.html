{% extends 'spot/base.html' %}
{% block title %}Ma demande de couverture{% endblock %}
{% block content %}
<div class="max-w-5xl mx-auto p-6 space-y-6">
  <div class="flex items-center justify-between">
    <h1 class="text-2xl font-bold">{{ coverage.event_title }}</h1>
    <div class="flex items-center gap-3">
      <span class="px-3 py-1 text-xs font-semibold rounded-full
        {% if coverage.status == 'new' %}bg-yellow-100 text-yellow-800{% endif %}
        {% if coverage.status == 'review' %}bg-blue-100 text-blue-800{% endif %}
        {% if coverage.status == 'scheduled' %}bg-green-100 text-green-800{% endif %}
        {% if coverage.status == 'closed' %}bg-gray-100 text-gray-800{% endif %}">
        {{ coverage.get_status_display }}
      </span>
      <a href="{% url 'dashboard' %}" class="text-bf1-red hover:underline">Retour</a>
    </div>
  </div>

  <section class="bg-white rounded-xl shadow-sm p-6">
    <h2 class="text-lg font-semibold mb-4">Détails de l’événement</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm">
      <div>
        <div class="text-gray-500">Type d’événement</div>
        <div class="font-medium">{{ coverage.get_event_type_display }}</div>
      </div>
      <div>
        <div class="text-gray-500">Date</div>
        <div class="font-medium">{{ coverage.event_date|date:'d/m/Y' }}</div>
      </div>
      <div>
        <div class="text-gray-500">Heures</div>
        <div class="font-medium">{{ coverage.start_time }}{% if coverage.end_time %} – {{ coverage.end_time }}{% endif %}</div>
      </div>
      <div class="md:col-span-2">
        <div class="text-gray-500">Adresse</div>
        <div class="font-medium">{{ coverage.address }}</div>
      </div>
      {% if coverage.meeting_point %}
      <div>
        <div class="text-gray-500">Point de rendez-vous</div>
        <div class="font-medium">{{ coverage.meeting_point }}</div>
      </div>
      {% endif %}
      <div>
        <div class="text-gray-500">Urgence</div>
        <div class="font-medium">{{ coverage.get_urgency_level_display }}</div>
      </div>
      {% if coverage.response_deadline %}
      <div>
        <div class="text-gray-500">Date limite de réponse</div>
        <div class="font-medium">{{ coverage.response_deadline|date:'d/m/Y' }}</div>
      </div>
      {% endif %}
    </div>
    {% if coverage.description %}
    <div class="mt-4">
      <div class="text-gray-500 mb-1">Description</div>
      <p class="text-sm leading-relaxed">{{ coverage.description }}</p>
    </div>
    {% endif %}
  </section>

  <section class="bg-white rounded-xl shadow-sm p-6">
    <h2 class="text-lg font-semibold mb-4">Contacts & préférences</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm">
      <div>
        <div class="text-gray-500">Contact presse</div>
        <div class="font-medium">{{ coverage.contact_name }}</div>
      </div>
      <div>
        <div class="text-gray-500">Téléphone</div>
        <div class="font-medium">{{ coverage.contact_phone }}</div>
      </div>
      <div>
        <div class="text-gray-500">Email</div>
        <div class="font-medium">{{ coverage.contact_email|default:'—' }}</div>
      </div>
      {% if coverage.other_contacts %}
      <div class="md:col-span-3">
        <div class="text-gray-500">Autres contacts</div>
        <div class="font-medium">{{ coverage.other_contacts }}</div>
      </div>
      {% endif %}
      <div>
        <div class="text-gray-500">Type de couverture</div>
        <div class="font-medium">{{ coverage.get_coverage_type_display }}</div>
      </div>
      {% if coverage.coverage_objective %}
      <div class="md:col-span-2">
        <div class="text-gray-500">Objectif</div>
        <div class="font-medium">{{ coverage.coverage_objective }}</div>
      </div>
      {% endif %}
    </div>
  </section>

  <section class="bg-white rounded-xl shadow-sm p-6">
    <div class="flex items-center justify-between">
      <h2 class="text-lg font-semibold">Documents joints</h2>
      <span class="text-sm text-gray-600">{{ attachments|length }} document(s)</span>
    </div>
    {% if attachments %}
    <ul class="mt-3 divide-y divide-gray-200">
      {% for att in attachments %}
      <li class="py-2 flex items-center justify-between">
        <div class="text-sm text-gray-800">{{ att.file.name|slice:'20:'|default:att.file.name }}</div>
        <a href="{{ att.file.url }}" target="_blank" rel="noopener" class="px-3 py-1 text-xs rounded border hover:bg-gray-50">Télécharger</a>
      </li>
      {% endfor %}
    </ul>
    {% else %}
    <p class="text-sm text-gray-600 mt-2">Aucun document joint.</p>
    {% endif %}
  </section>
</div>
{% endblock %}