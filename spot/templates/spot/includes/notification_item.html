{# Composant <li> réutilisable pour une notification #}
<li id="notif-{{ notification.id }}"
    data-notif-id="{{ notification.id }}"
    data-notif-is-read="{% if notification.is_read %}1{% else %}0{% endif %}"
    class="js-notif-item group p-4 rounded-lg border transition-colors
           {% if notification.type == 'warning' or notification.type == 'error' %}
               bg-yellow-50 border-yellow-200 text-yellow-800
           {% elif not notification.is_read %}
               bg-blue-50 border-blue-300 text-blue-800 animate-pulse
           {% else %}
               bg-gray-100 border-gray-200 text-gray-600
           {% endif %}">
  <div class="flex items-start justify-between">
    <div class="flex items-start gap-3">
      {# Icône #}
      <span class="inline-flex w-9 h-9 items-center justify-center rounded-full
                   {% if notification.type == 'warning' or notification.type == 'error' %} bg-yellow-100 text-yellow-600
                   {% elif not notification.is_read %} bg-blue-100 text-blue-600
                   {% else %} bg-gray-200 text-gray-600 {% endif %}">
        {% if notification.type == 'success' %}
          <i class="fas fa-check"></i>
        {% elif notification.type == 'error' %}
          <i class="fas fa-exclamation"></i>
        {% elif notification.type == 'warning' %}
          <i class="fas fa-exclamation-triangle"></i>
        {% else %}
          <i class="fas fa-bell{% if not notification.is_read %} fa-shake{% endif %}"></i>
        {% endif %}
      </span>
      <div>
        <p class="text-xs opacity-70">
          <i class="fas fa-clock mr-1"></i>il y a {{ notification.created_at|timesince }}
        </p>
        <h3 class="text-sm font-semibold flex items-center gap-2">
          {{ notification.title }}
          <span class="px-2 py-0.5 rounded-full text-xs border bg-gray-100 text-gray-700 border-gray-200">
            {{ notification.get_type_display }}
          </span>
          {% if not notification.is_read %}
            <span class="px-2 py-0.5 rounded-full text-xs border bg-bf1-red-light text-bf1-red border-bf1-red-light">
              Non lu
            </span>
          {% endif %}
        </h3>
        <p class="text-sm">{{ notification.message }}</p>
        {% if notification.related_thread %}
          {% if request.user.is_diffuser %}
            <a href="{% url 'diffusion_chat_thread' notification.related_thread.id %}"
               class="inline-flex items-center text-xs mt-2 underline">
               <i class="fas fa-comments mr-1"></i>Voir la discussion
            </a>
          {% elif request.user.is_editorial_manager %}
            <a href="{% url 'editorial_chat_thread' notification.related_thread.id %}"
               class="inline-flex items-center text-xs mt-2 underline">
               <i class="fas fa-comments mr-1"></i>Voir la discussion
            </a>
          {% else %}
            <a href="{% url 'correspondence_thread' notification.related_thread.id %}"
               class="inline-flex items-center text-xs mt-2 underline">
               <i class="fas fa-comments mr-1"></i>Voir la discussion
            </a>
          {% endif %}
        {% elif notification.related_spot %}
          {% if request.user.is_diffuser %}
            <a href="{% url 'diffusion_spot_detail' notification.related_spot.id %}"
               class="inline-flex items-center text-xs mt-2 underline">
               <i class="fas fa-bullhorn mr-1"></i>Voir le spot
            </a>
            {% if notification.type == 'error' or notification.type == 'warning' %}
            <a href="{% url 'diffusion_spots_late' %}"
               class="inline-flex items-center text-xs mt-2 underline ml-3">
               <i class="fas fa-hourglass-end mr-1"></i>Voir les retards
            </a>
            {% endif %}
          {% else %}
            <a href="{% url 'spot_detail' notification.related_spot.id %}"
               class="inline-flex items-center text-xs mt-2 underline">
               <i class="fas fa-bullhorn mr-1"></i>Voir le spot
            </a>
          {% endif %}
        {% elif notification.related_campaign %}
          <a href="{% url 'campaign_detail' notification.related_campaign.id %}"
             class="inline-flex items-center text-xs mt-2 underline">
             <i class="fas fa-external-link-alt mr-1"></i>Voir la campagne
          </a>
        {% elif notification.related_coverage %}
          <a href="{% url 'coverage_detail' notification.related_coverage.id %}"
             class="inline-flex items-center text-xs mt-2 underline">
             <i class="fas fa-newspaper mr-1"></i>Voir la demande de couverture
          </a>
        {% elif notification.related_contact and request.user.is_admin %}
          <a href="{% url 'admin_contact_request_detail' notification.related_contact.id %}"
             class="inline-flex items-center text-xs mt-2 underline">
             <i class="fas fa-envelope-open-text mr-1"></i>Voir la demande
          </a>
        {% endif %}
      </div>
    </div>
    <div class="flex items-center gap-2">
      <button type="button" class="js-notif-delete px-2 py-1 rounded-full bg-gray-100 text-gray-500 hover:bg-red-100 hover:text-red-600"
              onclick="deleteNotification('{{ notification.id }}')"
              title="Supprimer">
        <i class="fas fa-trash"></i>
      </button>
    </div>
  </div>
</li>
